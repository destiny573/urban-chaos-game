name: Deploy to GitHub Pages

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    permissions:
      contents: read
      pages: write
      id-token: write
    
    steps:
    - name: Checkout
      uses: actions/checkout@v4
    
    - name: Setup Godot
      uses: firebelley/setup-godot@v1
      with:
        godot-version: '4.2.1'
    
    - name: Create basic HTML5 game
      run: |
        mkdir -p build
        # Create a simple HTML file that can run our game
        cat > build/index.html << 'EOF'
        <!DOCTYPE html>
        <html>
        <head>
            <title>Urban Chaos - GTA Style Game</title>
            <style>
                body { margin: 0; padding: 0; background: #2ecc71; }
                #game { width: 100vw; height: 100vh; }
                #controls { position: absolute; bottom: 20px; left: 20px; color: white; }
            </style>
        </head>
        <body>
            <div id="game">
                <canvas id="canvas"></canvas>
                <div id="controls">
                    <p>ðŸŽ® Use Arrow Keys to move</p>
                    <p>ðŸš— Press E to enter/exit vehicle</p>
                    <p>ðŸ“± Touch controls on mobile</p>
                </div>
            </div>
            <script>
                // Simple game simulation for demo
                console.log("Urban Chaos Game Loading...");
                alert("Game would load here! In full version, Godot exports proper HTML5.");
            </script>
        </body>
        </html>
        EOF
    
    - name: Setup Pages
      uses: actions/configure-pages@v3
    
    - name: Upload artifact
      uses: actions/upload-pages-artifact@v2
      with:
        path: 'build'
    
    - name: Deploy to GitHub Pages
      id: deployment
      uses: actions/deploy-pages@v2
